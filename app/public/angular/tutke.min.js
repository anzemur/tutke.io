!function(){angular.module("tutke",["ngRoute"]).config(["$routeProvider","$locationProvider",function(e,t){e.when("/",{templateUrl:"index/index.component.html",controller:"indexCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"authentication/log-in/log-in.component.html",controller:"loginInCtrl",controllerAs:"vm"}).otherwise({redirecTo:"/"}),t.html5Mode(!0)}])}(),angular.module("tutke").directive("foot",function(){return{restrict:"EA",templateUrl:"/shared/directives/foot/foot.component.html"}}),angular.module("tutke").directive("navigation",function(){return{restrict:"EA",templateUrl:"/shared/directives/navigation/navigation.component.html"}}),function(){function e(e,t){var n=function(t){e.localStorage.jwt=t},o=function(){return e.localStorage.jwt},r=function(){var t=o();return!!t&&JSON.parse(e.atob(t.split(".")[1])).exDate>Date.now()/1e3};return{saveToken:n,getToken:o,doRegister:function(e){return t.post("/api/register",e).then(function(e){n(e.data.token)})},doLogIn:function(e){return t.post("/api/login",e).then(function(e){n(e.data.token)})},doLogOut:function(){e.localStorage.removeItem("token")},isLoggedIn:r,getCurrentUser:function(){if(r()){var n=o(),u=JSON.parse(e.atob(n.split(".")[1]));return t.get("/api/users/"+u._id,{params:{populate:!0}})}}}}e.$inject=["$window","$http"],angular.module("tutke").service("authentication",e)}(),function(){function e(e,t){return{getLecturesPaginated:function(e){return t.get("/api/lectures/",{params:{populate:!0,page:e.page,search:e.search,lectureType:e.lectureType}})}}}e.$inject=["$window","$http"],angular.module("tutke").service("lectures",e)}(),function(){function e(e,t,n){return{updateLectureRequest:function(e,o){var r={};return r.status=e?"accepted":"denied",t.put("api/lecturesRequests/"+o,r,{headers:{Authorization:"Bearer "+n.getToken()}})}}}e.$inject=["$window","$http","authentication"],angular.module("tutke").service("lecturesRequests",e)}(),(()=>{function e(e,t,n,o){var r=this;r.msgError="",r.msgSuccess="",r.isLoggedIn=t.isLoggedIn(),r.pagination={search:"",page:0,lectureType:"posted"},r.getLecturesPaginated=function(){n.getLecturesPaginated(r.pagination).then(function(e){r.lectures=e.data},function(e){r.msgError=e.e,console.log(e.e)})},r.answerToPendingLecture=function(e,t){o.updateLectureRequest(e,t).then(function(n){r.msgSuccess=e?"Lecture request accepted.":"Lecture request denied.",r.user.lecturesRequests=r.user.lecturesRequests.filter(e=>e._id!=t),console.log(r.msgSuccess)},function(e){r.msgError=e.e,console.log(e.e)})},r.doSearch=function(){r.pagination.page=0,r.getLecturesPaginated()},r.changeLectureType=function(e){r.pagination.lectureType!=e&&(r.pagination.lectureType="posted"==r.pagination.lectureType?"requested":"posted",r.getLecturesPaginated())},r.changePage=function(e){e?r.pagination.page++:r.pagination.page--,r.getLecturesPaginated()},r.isLoggedIn&&t.getCurrentUser().then(function(e){r.user=e.data},function(e){r.isLoggedIn=!1,t.doLogOut(),console.log(e.e)}),r.getLecturesPaginated()}e.$inject=["$location","authentication","lectures","lecturesRequests"],angular.module("tutke").controller("indexCtrl",e)})(),function(){function e(e,t){var n=this;n.logInData={username:"",password:""},n.logInError="",n.indexPage=e.search().page||"/",n.checkLogInData=function(){if(n.logInError="",!n.logInData.username||!n.logInData.password)return n.logInError="Please enter username and password then try again.",!1;n.doLogIn()},n.doLogIn=function(){n.logInError="",t.doLogIn(n.logInData).then(function(t){e.search("page",null),e.path(n.indexPage)},function(e){n.logInError=e.data.message})}}e.$inject=["$location","authentication"],angular.module("tutke").controller("loginInCtrl",e)}(),angular.module("tutke").filter("getFilteredStudentsRequests",function(){return function(e){return e.filter(e=>"pending"==e.status&&"studentRequest"==e.requestType)}}),angular.module("tutke").filter("getFilteredTutorsRequests",function(){return function(e){return e.filter(e=>"pending"==e.status&&"tutorOffer"==e.requestType)}});